unit jogoDaVelha;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.ExtCtrls, Vcl.Imaging.pngimage,
  Vcl.StdCtrls;

type
  TForm1 = class(TForm)
    Image1: TImage;
    btnComecar: TButton;
    lblMarca5: TLabel;
    lblMarca1: TLabel;
    lblMarca2: TLabel;
    lblMarca3: TLabel;
    lblMarca6: TLabel;
    lblMarca4: TLabel;
    lblMarca7: TLabel;
    lblMarca8: TLabel;
    lblMarca9: TLabel;
    Label1: TLabel;
    Label2: TLabel;
    lblPonto1: TLabel;
    lblPonto2: TLabel;
    procedure lblMarca1Click(Sender: TObject);
    procedure btnComecarClick(Sender: TObject);
    procedure lblMarca2Click(Sender: TObject);
    procedure lblMarca3Click(Sender: TObject);
    procedure lblMarca4Click(Sender: TObject);
    procedure lblMarca5Click(Sender: TObject);
    procedure lblMarca6Click(Sender: TObject);
    procedure lblMarca7Click(Sender: TObject);
    procedure lblMarca8Click(Sender: TObject);
    procedure lblMarca9Click(Sender: TObject);
  private
    FPonto1: Integer;
    FPonto2: Integer;
//    lCampos: array[1..9] of TLabel;
    procedure MarcarCampo(lblMarcada: TLabel; lSimbolo: string);
    procedure PegarSimbolo(lCampos: array of TLabel;
      var Simbolo: string);
    procedure ArmazenarCampos(var lCampos: array of Tlabel);
    procedure MarcarVitoria(lCampos: array of TLabel);
    procedure MarcarPonto(Posicao: Integer;Ponto1: Integer; Ponto2: Integer);
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

procedure TForm1.ArmazenarCampos(var lCampos: array of Tlabel);
begin
  lCampos[0] := lblMarca1;
  lCampos[1] := lblMarca2;
  lCampos[2] := lblMarca3;
  lCampos[3] := lblMarca4;
  lCampos[4] := lblMarca5;
  lCampos[5] := lblMarca6;
  lCampos[6] := lblMarca7;
  lCampos[7] := lblMarca8;
  lCampos[8] := lblMarca9;
end;

procedure TForm1.btnComecarClick(Sender: TObject);
begin
  FPonto1 := 0;
  FPonto2 := 0;

  btnComecar.Visible := False;
end;

procedure TForm1.lblMarca1Click(Sender: TObject);
var
  lSimbolo: string;
  lCampos: array[1..9] of TLabel;
begin
  ArmazenarCampos(lCampos);
  PegarSimbolo(lCampos, lSimbolo);
  MarcarCampo(lblMarca1, lSimbolo);
  ArmazenarCampos(lCampos);
  MarcarVitoria(lCampos);
end;

procedure TForm1.lblMarca2Click(Sender: TObject);
var
  lSimbolo: string;
  lCampos: array[1..9] of TLabel;
begin
  ArmazenarCampos(lCampos);
  PegarSimbolo(lCampos, lSimbolo);
  MarcarCampo(lblMarca2, lSimbolo);
  ArmazenarCampos(lCampos);
  MarcarVitoria(lCampos);
end;

procedure TForm1.lblMarca3Click(Sender: TObject);
var
  lSimbolo: string;
  lCampos: array[1..9] of TLabel;
begin
  ArmazenarCampos(lCampos);
  PegarSimbolo(lCampos, lSimbolo);
  MarcarCampo(lblMarca3, lSimbolo);
  ArmazenarCampos(lCampos);
  MarcarVitoria(lCampos);
end;

procedure TForm1.lblMarca4Click(Sender: TObject);
var
  lSimbolo: string;
  lCampos: array[1..9] of TLabel;
begin
  ArmazenarCampos(lCampos);
  PegarSimbolo(lCampos, lSimbolo);
  MarcarCampo(lblMarca4, lSimbolo);
  ArmazenarCampos(lCampos);
  MarcarVitoria(lCampos);
end;

procedure TForm1.lblMarca5Click(Sender: TObject);
var
  lSimbolo: string;
  lCampos: array[1..9] of TLabel;
begin
  ArmazenarCampos(lCampos);
  PegarSimbolo(lCampos, lSimbolo);
  MarcarCampo(lblMarca5, lSimbolo);
  ArmazenarCampos(lCampos);
  MarcarVitoria(lCampos);
end;

procedure TForm1.lblMarca6Click(Sender: TObject);
var
  lSimbolo: string;
  lCampos: array[1..9] of TLabel;
begin
  ArmazenarCampos(lCampos);
  PegarSimbolo(lCampos, lSimbolo);
  MarcarCampo(lblMarca6, lSimbolo);
  ArmazenarCampos(lCampos);
  MarcarVitoria(lCampos);
end;

procedure TForm1.lblMarca7Click(Sender: TObject);
var
  lSimbolo: string;
  lCampos: array[1..9] of TLabel;
begin
  ArmazenarCampos(lCampos);
  PegarSimbolo(lCampos, lSimbolo);
  MarcarCampo(lblMarca7, lSimbolo);
  ArmazenarCampos(lCampos);
  MarcarVitoria(lCampos);
end;

procedure TForm1.lblMarca8Click(Sender: TObject);
var
  lSimbolo: string;
  lCampos: array[1..9] of TLabel;
begin
  ArmazenarCampos(lCampos);
  PegarSimbolo(lCampos, lSimbolo);
  MarcarCampo(lblMarca8, lSimbolo);
  ArmazenarCampos(lCampos);
  MarcarVitoria(lCampos);
end;

procedure TForm1.lblMarca9Click(Sender: TObject);
var
  lSimbolo: string;
  lCampos: array[1..9] of TLabel;
begin
  ArmazenarCampos(lCampos);
  PegarSimbolo(lCampos, lSimbolo);
  MarcarCampo(lblMarca9, lSimbolo);
  ArmazenarCampos(lCampos);
  MarcarVitoria(lCampos);
end;

procedure TForm1.MarcarCampo(lblMarcada: TLabel; lSimbolo: string);
begin
  if lblMarcada.Font.Color = clWhite then
    begin
       if lSimbolo = 'O' then lblMarcada.Caption := 'O'
       else lblMarcada.Caption := 'X';
       lblMarcada.Font.Color := clPurple;
    end;
end;

procedure TForm1.MarcarPonto(Posicao: Integer; Ponto1: Integer; Ponto2: Integer);
var
  lCampos: array[1..9] of TLabel;
  lContador: Integer;
begin
  ArmazenarCampos(lCampos);
  if (lCampos[Posicao].Caption = 'O') then
    Ponto2 := Ponto2+1
  else
    Ponto1 := Ponto1+1;

  lblPonto1.Caption := IntToStr(Ponto1);
  lblPonto2.Caption := IntToStr(Ponto2);
  for lContador := 1 to 9 do lCampos[lContador].Font.Color := clWhite;
end;

procedure TForm1.MarcarVitoria(lCampos: array of TLabel);
var
  lContador: Integer;
begin
  if (lCampos[0].Caption = lCampos[1].Caption) AND (lCampos[0].Font.Color <> clWhite) AND (lCampos[1].Font.Color <> clWhite) AND (lCampos[1].Caption = lCampos[2].Caption) then
    begin
      MarcarPonto(1, FPonto1, FPonto2);
    end
  else if (lCampos[0].Caption = lCampos[3].Caption) AND (lCampos[0].Font.Color <> clWhite) AND (lCampos[3].Caption = lCampos[6].Caption) AND (lCampos[3].Font.Color <> clWhite) then
    begin
      MarcarPonto(1, FPonto1, FPonto2);
    end
  else if (lCampos[0].Caption = lCampos[4].Caption) AND (lCampos[0].Font.Color <> clWhite) AND (lCampos[4].Caption = lCampos[8].Caption) AND (lCampos[4].Font.Color <> clWhite) then
    begin
      MarcarPonto(1, FPonto1, FPonto2);
    end
  else if (lCampos[1].Caption = lCampos[4].Caption) AND (lCampos[1].Font.Color <> clWhite) AND (lCampos[4].Caption = lCampos[7].Caption) AND (lCampos[4].Font.Color <> clWhite) then
    begin
      MarcarPonto(2, FPonto1, FPonto2);
    end
  else if (lCampos[2].Caption = lCampos[5].Caption) AND (lCampos[2].Font.Color <> clWhite) AND (lCampos[5].Caption = lCampos[8].Caption) AND (lCampos[5].Font.Color <> clWhite) then
    begin
      MarcarPonto(3, FPonto1, FPonto2);
    end
  else if (lCampos[3].Caption = lCampos[4].Caption) AND (lCampos[3].Font.Color <> clWhite) AND (lCampos[4].Caption = lCampos[5].Caption) AND (lCampos[4].Font.Color <> clWhite) then
    begin
      MarcarPonto(4, FPonto1, FPonto2);
    end
  else if (lCampos[6].Caption = lCampos[7].Caption) AND (lCampos[6].Font.Color <> clWhite) AND (lCampos[7].Caption = lCampos[8].Caption) AND (lCampos[7].Font.Color <> clWhite) then
    begin
      MarcarPonto(7, FPonto1, FPonto2);
    end
  else if (lCampos[2].Caption = lCampos[4].Caption) AND (lCampos[2].Font.Color <> clWhite) AND (lCampos[4].Caption = lCampos[6].Caption) AND (lCampos[4].Font.Color <> clWhite) then
    begin
      MarcarPonto(3, FPonto1, FPonto2);
    end;


//    begin
//      if (lCampos[4].Caption = 'O') OR (lCampos[0].Caption = 'O') OR
//      (lCampos[8].Caption = 'O') then
//        FPonto2 := FPonto2+1
//      else
//        FPonto1 := FPonto1+1;
//      for lContador := 0 to 8 do lCampos[lContador].Font.Color := clWhite;
//    end;

//  lblPonto1.Caption := IntToStr(FPonto1);
//  lblPonto2.Caption := IntToStr(FPonto2);


end;

procedure TForm1.PegarSimbolo(lCampos: array of TLabel; var Simbolo: string);
var
  lContador, lQuantidade: Integer;
  lSimbolo: string;
begin
  lQuantidade := 0;

  for lContador := 0 to 8 do
      if lCampos[lContador].Font.Color <> clWhite then lQuantidade := lQuantidade+1;

  if (lQuantidade Mod 2) = 0 then Simbolo := 'X'
  else Simbolo := 'O';
end;

end.
